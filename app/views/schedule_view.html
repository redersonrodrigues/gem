{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2>Cadastrar Escala Plantonista</h2>
    <form method="POST" class="mb-4">
        <input type="hidden" name="tipo" value="PLANTONISTA">
        <div class="mb-3">
            <label for="data_escala" class="form-label">Data</label>
            <input type="date" class="form-control" id="data_escala" name="data_escala" required>
        </div>
        <div class="mb-3">
            <label class="form-label">Turno Diurno (07:30)</label>
            <div class="row">
                <div class="col">
                    <label for="diurno_medico1_id" class="form-label">Médico 1</label>
                    <select class="form-select text-uppercase" id="diurno_medico1_id" name="diurno_medico1_id" required
                        style="text-transform:uppercase;">
                        <option value="">Selecione</option>
                        {% for doctor in doctors %}
                        <option value="{{ doctor.id }}">{{ doctor.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col">
                    <label for="diurno_medico2_id" class="form-label">Médico 2</label>
                    <select class="form-select text-uppercase" id="diurno_medico2_id" name="diurno_medico2_id" required
                        style="text-transform:uppercase;">
                        <option value="">Selecione</option>
                        {% for doctor in doctors %}
                        <option value="{{ doctor.id }}">{{ doctor.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
        <div class="mb-3">
            <label class="form-label">Turno Noturno (19:30)</label>
            <div class="row">
                <div class="col">
                    <label for="noturno_medico1_id" class="form-label">Médico 1</label>
                    <select class="form-select text-uppercase" id="noturno_medico1_id" name="noturno_medico1_id"
                        required style="text-transform:uppercase;">
                        <option value="">Selecione</option>
                        {% for doctor in doctors %}
                        <option value="{{ doctor.id }}">{{ doctor.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="col">
                    <label for="noturno_medico2_id" class="form-label">Médico 2</label>
                    <select class="form-select text-uppercase" id="noturno_medico2_id" name="noturno_medico2_id"
                        required style="text-transform:uppercase;">
                        <option value="">Selecione</option>
                        {% for doctor in doctors %}
                        <option value="{{ doctor.id }}">{{ doctor.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
        <button type="submit" class="btn btn-primary">Cadastrar Escala</button>
    </form>
    <h3>Escalas Plantonistas Cadastradas</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Data</th>
                <th>Diurno Médico 1</th>
                <th>Diurno Médico 2</th>
                <th>Noturno Médico 1</th>
                <th>Noturno Médico 2</th>
            </tr>
        </thead>
        <tbody>
            {% for escala in escalas %}
            <tr>
                <td>{{ escala.data }}</td>
                <td>{{ escala.diurno_medico1.name if escala.diurno_medico1 else '' }}</td>
                <td>{{ escala.diurno_medico2.name if escala.diurno_medico2 else '' }}</td>
                <td>{{ escala.noturno_medico1.name if escala.noturno_medico1 else '' }}</td>
                <td>{{ escala.noturno_medico2.name if escala.noturno_medico2 else '' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <h2>Cadastrar Escala de Sobreaviso</h2>
    <form method="POST" class="mb-4">
        <input type="hidden" name="tipo" value="SOBREAVISO">
        <div class="mb-3">
            <label for="especialidade_sobreaviso" class="form-label">Especialidade</label>
            <select class="form-select text-uppercase" id="especialidade_sobreaviso" name="especialidade_sobreaviso"
                required style="text-transform:uppercase;">
                <option value="">Selecione</option>
                {% for specialization in specializations %}
                <option value="{{ specialization.name }}">{{ specialization.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="mb-3">
            <label for="data_inicio" class="form-label">Data Inicial</label>
            <input type="date" class="form-control" id="data_inicio" name="data_inicio" required>
        </div>
        <div class="mb-3">
            <label for="periodo" class="form-label">Período</label>
            <select class="form-select" id="periodo" name="periodo" required>
                <option value="">Selecione</option>
                <option value="quinzenal">Quinzenal (Ortopedia)</option>
                <option value="semanal">Semanal (Demais Especialidades)</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="medico_sobreaviso" class="form-label">Médico de Sobreaviso</label>
            <select class="form-select text-uppercase" id="medico_sobreaviso" name="medico_sobreaviso" required
                style="text-transform:uppercase;">
                <option value="">Selecione</option>
                {% for doctor in doctors %}
                <option value="{{ doctor.id }}">{{ doctor.name }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-secondary">Cadastrar Sobreaviso</button>
    </form>
    <h3>Escalas de Sobreaviso Cadastradas</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Especialidade</th>
                <th>Data Inicial</th>
                <th>Período</th>
                <th>Médico</th>
            </tr>
        </thead>
        <tbody>
            {% for escala in escalas if escala.tipo == 'SOBREAVISO' %}
            <tr>
                <td>{{ escala.sobreaviso_especialidade }}</td>
                <td>{{ escala.data }}</td>
                <td>{% if escala.sobreaviso_especialidade == 'ORTOPEDIA' %}Quinzenal{% else %}Semanal{% endif %}</td>
                <td>{{ escala.sobreaviso_medico.name if escala.sobreaviso_medico else '' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}